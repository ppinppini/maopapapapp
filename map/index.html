<!DOCTYPE html>
<html>

<head>
   <title>ìœ„ì¹˜ê¸°ë°˜ ì§€ì—­ì •ë³´ ê²€ìƒ‰</title>
   <meta http-equiv="content-type" content="text/html;charset=UTF-8">
   <link rel="stylesheet" href="mapcss.css">
</head>

<body class="docs framebox_body">
   <!-- <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=places"></script> -->
   <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDY9JXaSCF1_OzdOHv6Md2UMSxCzHItx80&libraries=places"></script>
    <script type="text/javascript">
      var map, places, iw;
      var markers = [];
      var autocomplete;
      

      

        //ì§€ë„ ì„¤ì •
      function initialize() {
         var myLatlng = new google.maps.LatLng(37.566535, 126.97796919999996);
         var myOptions = {
            zoom: 14,
            center: myLatlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
         };
         map = new google.maps.Map(document.getElementById('map_canvas'), myOptions);
         places = new google.maps.places.PlacesService(map);
         google.maps.event.addListener(map, 'tilesloaded', tilesLoaded);
         autocomplete = new google.maps.places.Autocomplete(document.getElementById('autocomplete'));
         google.maps.event.addListener(autocomplete, 'place_changed', function () {
            showSelectedPlace();
         });
      }
        //ì§€ë„ ì„¤ì •

        //ì§€ë„ í¬ê¸° ì¡°ì ˆ
      function tilesLoaded() {
         google.maps.event.clearListeners(map, 'tilesloaded');
         google.maps.event.addListener(map, 'zoom_changed', search);
         google.maps.event.addListener(map, 'dragend', search);
         search();
      }
        //ì§€ë„ í¬ê¸° ì¡°ì ˆ

        //ì¹´í…Œê³ ë¦¬ ê²€ìƒ‰ 
      function showSelectedPlace() {
         clearResults();
         clearMarkers();
         var place = autocomplete.getPlace();
         // alert(place.geometry.location);
         //ê²€ìƒ‰ìœ„ì¹˜ ì¢Œí‘œ
         map.panTo(place.geometry.location);
         markers[0] = new google.maps.Marker({
            position: place.geometry.location,
            map: map
         });
         iw = new google.maps.InfoWindow({
            content: getIWContent(place)
         });
         iw.open(map, markers[0]);
      }
        //ì¹´í…Œê³ ë¦¬ ê²€ìƒ‰


      function search() {
         var type;
         for (var i = 0; i < document.controls.type.length; i++) {
            if (document.controls.type[i].checked) {
               type = document.controls.type[i].value;
            }
         }
         autocomplete.setBounds(map.getBounds());
         var search = {
            bounds: map.getBounds()
         };
         if (type != 'establishment') {
            search.types = [type];
         }
         places.search(search, function (results, status) {
            if (status == google.maps.places.PlacesServiceStatus.OK) {
               clearResults();
               clearMarkers();
               for (var i = 0; i < results.length; i++) {
                  markers[i] = new google.maps.Marker({
                     position: results[i].geometry.location,
                     animation: google.maps.Animation.null //ë§ˆì»¤ ì• ë‹ˆë©”ì´ì…˜
					});
					google.maps.event.addListener(markers[i], 'click', getDetails(results[i], i));
					google.maps.event.addListener(markers[i], 'pass', senddata(results[i], i));
                  setTimeout(dropMarker(i), i * 100);
                  addResult(results[i], i);
               }
            }
         });
      }

      function clearMarkers() {
         for (var i = 0; i < markers.length; i++) {
            if (markers[i]) {
               markers[i].setMap(null);
               markers[i] == null;
            }
         }
      }

      function dropMarker(i) {
         return function () {
            markers[i].setMap(map);
         }
      }

      function addResult(result, i) {
         var results = document.getElementById('results');
         var tr = document.createElement('tr');
         tr.style.backgroundColor = (i % 2 == 0 ? '#A4EBF3' : '#A4EBF3');
         tr.onclick = function () {
            google.maps.event.trigger(markers[i], 'click');
            google.maps.event.trigger(markers[i], 'pass');
         };
         var iconTd = document.createElement('td');
         var nameTd = document.createElement('td');
         var icon = document.createElement('img');        
		 icon.src = result.icon.replace('http:', '');
        // ì‹œì„¤ ëª©ë¡ ì´ë¯¸ì§€
      //   icon.src = result.icon.replace('https://maps.gstatic.com/mapfiles/place_api/icons/v1/png_71/','https://github.com/kimseungmin1/map/blob/master/');
      //  ì´ë¯¸ì§€ì£¼ì†Œ https://github.com/kimseungmin1/map/blob/master/hospital-71.png
      

		 icon.setAttribute('class', 'placeIcon');
         var name = document.createTextNode(result.name);
         iconTd.appendChild(icon);
		 //ì´ë¯¸ì§€ ì¶”ê°€
         nameTd.appendChild(name);
		 //ì‹œì„¤ ì´ë¦„ ì¶”ê°€
         tr.appendChild(iconTd);
		 //ì´ë¯¸ì§€ê°€ ë“¤ì–´ê°ˆ í‹€ ì¶”ê°€
         tr.appendChild(nameTd);
		 //ì‹œì„¤ ì´ë¦„ ë“¤ì–´ê°ˆ í‹€ ì¶”ê°€
         results.appendChild(tr);
      }

      function clearResults() {
         var results = document.getElementById('results');
         while (results.childNodes[0]) {
            results.removeChild(results.childNodes[0]);
         }
      }

      function getDetails(result, i) {
         return function () {
            places.getDetails({
               reference: result.reference
            }, showInfoWindow(i));
         }
      }

	  function senddata(){
      autocomplete2 = new google.maps.places.Autocomplete(document.getElementById('autocomplete2'));
      // const data = document.getElementById('mylist');
      // data.innertext = document.getElementById('autocomplete2');
		// ìë™ì™„ì„± ê²€ìƒ‰ìœ¼ë¡œ ë©”ëª¨ì¥ì— ì¶”ê°€í•˜ê¸°

	  }

      function showInfoWindow(i) {
         return function (place, status) {
            if (iw) {
               iw.close();
               iw = null;
            }
            if (status == google.maps.places.PlacesServiceStatus.OK) {
               iw = new google.maps.InfoWindow({
                  content: getIWContent(place)
               });
               iw.open(map, markers[i]);
            }
         }
      }

      function getIWContent(place) {
         var content = '<table style="border:0"><tr><td style="border:0;">';
         content += '<img class="placeIcon" src="' + place.icon + '"></td>';
         // ì •ë³´ì°½ ì´ë¯¸ì§€ ì¶”ê°€
         content += '<td style="border:0;"><b><a href="' + place.url + '">' + place.name + '</a></b>';
         content += '</td></tr></table>';
         return content;
      }
      google.maps.event.addDomListener(window, 'load', initialize);

      /*
       * ë©”ì¸ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ëŠ” í•¨ìˆ˜
       */
      function goHome() {
         location.replace('http://localhost:3000/')
      }
   </script>
   <style type="text/css">
      
        html, body {
         margin: 0;
         padding: 0;
         height: 100%;
         font-family: arial;
         font-size: 13px;

      }

        /* ì§€ë„ css */
      #map_canvas {
         float: center;
         width: 820px;
         height: 406px;
      }
        
        /* ì£¼ë³€ ì‹œì„¤ ëª©ë¡ì„ ë‹´ëŠ” ì¹¸ */
      #listing {
         float: left;
         margin-left: 1px;
         width: 205px;
         height: 326px;
         overflow: auto;
         cursor: pointer;
      }

        /* ì¹´í…Œê³ ë¦¬ ëª©ë¡ */
      #controls {
         padding: 5px;
      }

        /* ì‹œì„¤ ëª©ë¡ì˜ ì´ë¯¸ì§€ í¬ê¸° */
      .placeIcon {
         width: 16px;
         height: 16px;
         margin: 2px;
      }

        /* ì£¼ë³€ ì‹œì„¤ ì´ë¦„ ëª©ë¡ */
      #results {
         border-collapse: collapse;
         width: 184px;
      }

        /* ì£¼ì†Œ ì…ë ¥ ìœ„ì¹˜ */
      #locationField {
         margin-left: 1px;
      }
        /* ì£¼ì†Œ ì…ë ¥ ì¹¸ í¬ê¸° */
      #autocomplete {
         width: 516px;
         border: 3px solid #ccc;
      }
   </style>
   <hr><h2>ğŸŒ êµ­ë‚´ ì—¬í–‰ì§€ ì°¾ê¸° ğŸŒ</h2><hr><br>
   <!-- ì£¼ì†Œ ê²€ìƒ‰ì°½  -->
   <div id="locationField">
      <input id="autocomplete" type="text">
   </div> <br>

   <!-- <div>
	<input id="autocomplete2" type="text" >
   </div>

   <div>
      <input id="mylist" type="text" >
   </div> -->

   <!-- ë§µ -->
   <div id="map_canvas"></div>
   <div id="controls">
      <form name="controls"><h3 id="memo">< ì£¼ë³€ì‹œì„¤ >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h3>
         <input type="radio" name="type" value="tourist_attraction" onclick="search()" checked="checked" />ê´€ê´‘ì§€
         <br/>
            <input type="radio" name="type" value="cafe" onclick="search()"  />ì¹´í˜
         <br/>
            <input type="radio" name="type" value="store" onclick="search()"  />ë§ˆíŠ¸
         <br/>
         <input type="radio" name="type" value="hospital" onclick="search()" />ë³‘ì›
         <br/>
         <input type="radio" name="type" value="restaurant" onclick="search()" />ì‹ë‹¹
         <br/>
   <br>
   <!-- ì‹œì„¤ ë¦¬ìŠ¤íŠ¸ ëª©ë¡ -->
   <div id="listing">
      <table id="results"></table>
   </div>
   <br>
      <h1 id="textarea-title">âœ ë©”ëª¨ì¥</h1>
    <textarea id="story" name="story" rows="5" cols="33">

   </textarea>
   <br>
   <a id="ad" class="mt-5 banner" href="https://www.codelion.net/catalog/Q291cnNlTm9kZTpqbW9r?utm_source=animal_test&utm_medium=web_lecture&utm_campaign=yunbumkun36@likelion.org">
      <img class="banner-img" src="banner.png" alt="banner" width="200" height="300">
   </a>
</body>

</html>